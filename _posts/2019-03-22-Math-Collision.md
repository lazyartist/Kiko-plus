---
layout: post
title: "Math - Collision"
description: ""
date: 2019-03-22 19:00:00+09:00
tags: [game, math, math]
comments: true
share: true
---

#### 충돌 판정에 사용하는 형태

|        형태         | 특징                                                         | 구조체                                                       |
| :-----------------: | ------------------------------------------------------------ | ------------------------------------------------------------ |
|        선분         | - 좌표 2개를 이은 선<br />- 굵기가 없는 선 형태              | 시작점, 벡터                                                 |
|         구          | - 중심에서 같은 거리에 있는 면으로 만든 형태<br />- 중심과 반지름으로 표현 | 중심좌표, 반지름                                             |
| 평면<br /> (삼각형) | - 3차원 공간에 무한히 퍼져 있는 평평한 면<br />- 평면 방정식으로 표현<br />- 삼각형일 때는 평면을 범위로 제한 | - 평면의 성분<br />- 꼭짓점 3개, 삼각형을 포함하는 평면(계산 편의) |



#### 선분과 선분 충돌

###### 직선의 방정식


$$
P:시작점, V:벡터 \\
y = \frac{V_y}{V_x}(x-p_x)+p_y
$$

###### 직선의 충돌(교점)

직선이 충돌한다는 것은 교점이 있다는 것

두 직선의 방정식을 연립하여 해를 구하면 된다.

​	해가 없다. -> 교점이 없다. 충돌(교차)하지 않는다.

​	해가 무수히 많다. -> 두 직선이 겹친다. 기울기와 y절편이 같다. 충돌(교차)하지 않는다.

​	해가 하나이다. -> 교점이 있다. 충돌(교차)한다.

$$
P:시작점, a:기울기 \\
y = a_1(x-p_{1x})+p_{1y} \\
y = a_2(x-p_{2x})+p_{2y} \\
$$


$$
\text{y에 대입}\\\\
a_1(x-p_{1x})+p_{1y} = a_2(x-p_{2x})+p_{2y} \\
a_1x-a_1p_{1x}+p_{1y} = a_2x-a_2p_{2x}+p_{2y} \\
a_1x-a_2x = -a_2p_{2x}+p_{2y}+a_1p_{1x}-p_{1y} \\
\therefore x = \frac{-a_2p_{2x}+p_{2y}+a_1p_{1x}-p_{1y}}{a_1-a_2} \\
$$


$$
\text{x에 대입}\\\\
y = a_1x-a_1p_{1x}+p_{1y}\\
y = a_1(\frac{-a_2p_{2x}+p_{2y}+a_1p_{1x}-p_{1y}}{a_1-a_2})-a_1p_{1x}+p_{1y} \\
y = \frac{-a_1a_2p_{2x}+a_1p_{2y}+a_1^2p_{1x}-a_1p_{1y}}{a_1-a_2}-a_1p_{1x}+p_{1y} \\
y = \frac{-a_1a_2p_{2x}+a_1p_{2y}+a_1^2p_{1x}-a_1p_{1y}}{a_1-a_2} - 
\frac{a_1^2p_{1x}-a_1a_2p_{1x}}{a_1-a_2} +
\frac{a_1p_{1y}-a_2p_{1y}}{a_1-a_2} \\
y = \frac{-a_1a_2p_{2x}+a_1p_{2y}+\cancel{a_1^2p_{1x}}-\cancel{a_1p_{1y}} - \cancel{a_1^2p_{1x}} + a_1a_2p_{1x} + \cancel{a_1p_{1y}}-a_2p_{1y}}{a_1-a_2} \\
\therefore y = \frac{-a_1a_2p_{2x}+a_1p_{2y} + a_1a_2p_{1x} - a_2p_{1y}}{a_1-a_2}
$$



###### 선분의 충돌(교점)

직선의 교점이 두 선분의 영역안에 있는지 확인한다.

x축 방향 벡터가 0이면 기울기 계산 시 0으로 나누게 되므로 다른 처리가 필요하다.

- 기울기가 같다 : 평행
- 기울기가 같고 y절편이 다르다 : 평행
- 기울기가 같고 y절편이 같다 : 겹침

